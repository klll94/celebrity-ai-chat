# Coze API 配置指南

本指南将详细说明如何将你在Coze平台创建的名人智能体接入到网页应用中。

## 📋 前置准备

### 1. 确认你的Coze智能体
- 你已经在Coze平台创建了4个名人智能体
- 这些智能体已经发布并可以通过API调用
- 你有Coze平台的账号和访问权限

### 2. 需要获取的信息
对于每个智能体，你需要获取：
- **Bot ID**：智能体的唯一标识符
- **API Key**：你的Coze平台API密钥

## 🔍 获取API信息

### 步骤1：登录Coze平台
1. 打开浏览器，访问 [https://coze.cn](https://coze.cn)
2. 使用你的账号登录

### 步骤2：找到你的智能体
1. 在主界面找到你创建的名人智能体
2. 点击进入其中一个智能体的详情页

### 步骤3：获取Bot ID
1. 在智能体详情页，找到并点击"发布"按钮
2. 选择"API调用"选项
3. 在API调用页面，你会看到类似这样的信息：
   ```
   Bot ID: 7123456789012345678
   ```
4. 复制这个Bot ID，记录下来

### 步骤4：获取API Key
1. 点击页面上的"API密钥"或"API Key"链接
2. 如果没有密钥，点击"创建新密钥"
3. 复制生成的API Key，格式类似：
   ```
   pat_1234567890abcdef1234567890abcdef
   ```

### 步骤5：重复以上步骤
对你的其他3个名人智能体重复步骤2-4，获取每个的Bot ID。

## ⚙️ 配置网页应用

### 找到配置文件
打开项目中的 `js/app.js` 文件，找到 `characters` 配置对象。

### 替换配置信息
根据你获取的信息，替换对应的占位符：

```javascript
const characters = {
    'libai': {
        name: '李白',
        botId: '7123456789012345678',        // 替换为李白智能体的Bot ID
        apiKey: 'pat_1234567890abcdef1234567890abcdef', // 替换为你的API Key
        avatar: 'images/libai.jpg',
        welcomeMessage: '哈哈！我是李白，诗仙李太白是也！...'
    },
    'wangwei': {
        name: '王维',
        botId: '7234567890123456789',        // 替换为王维智能体的Bot ID
        apiKey: 'pat_1234567890abcdef1234567890abcdef', // 使用相同的API Key
        avatar: 'images/wangwei.jpg',
        welcomeMessage: '施主有礼了。贫道王维，字摩诘...'
    },
    // 继续配置其他智能体...
};
```

### 配置注意事项

1. **API Key通用**：通常一个Coze账号的API Key对所有智能体都是通用的
2. **Bot ID唯一**：每个智能体都有自己独特的Bot ID
3. **名称匹配**：确保网页中的角色名称与Coze中的智能体角色匹配
4. **引号格式**：确保Bot ID和API Key都用引号包围

## 🧪 测试配置

### 1. 保存文件
确保所有修改都已保存到 `js/app.js` 文件中。

### 2. 打开网页
在浏览器中打开 `index.html`。

### 3. 选择名人
点击你已配置API的名人卡片（如李白）。

### 4. 发送测试消息
- 输入一个简单的问题，如"你好"
- 点击发送按钮
- 如果配置正确，你应该能收到来自Coze智能体的回复

## 🐛 常见问题排查

### 问题1：收到错误提示"API请求失败"
**可能原因**：
- Bot ID或API Key配置错误
- 网络连接问题
- Coze API服务暂时不可用

**解决方法**：
1. 检查Bot ID和API Key是否正确复制
2. 确认网络连接正常
3. 查看浏览器控制台(F12)的错误信息

### 问题2：智能体回复不符合预期
**可能原因**：
- Bot ID对应的智能体不正确
- 智能体在Coze平台的设置需要调整

**解决方法**：
1. 确认Bot ID对应正确的智能体
2. 回到Coze平台检查智能体的设置和训练情况

### 问题3：跨域请求被阻止
**可能原因**：
- 浏览器的CORS策略限制

**解决方法**：
1. 使用HTTP服务器运行网页（而不是直接打开文件）
2. 或者使用支持CORS的浏览器设置

## 📊 API调用格式参考

你的网页应用会向Coze发送这样的请求：

```javascript
// 请求URL
POST https://api.coze.cn/open_api/v2/chat

// 请求头
Authorization: Bearer your_api_key
Content-Type: application/json

// 请求体
{
    "bot_id": "your_bot_id",
    "user": "user_unique_id",
    "query": "用户的问题",
    "stream": false
}
```

## 🔄 切换回模拟模式

如果API配置遇到问题，你可以临时切换回模拟模式：

1. 将 `botId` 改回 `'YOUR_LIBAI_BOT_ID'`
2. 将 `apiKey` 改回 `'YOUR_COZE_API_KEY'`
3. 应用会自动使用内置的模拟回复

## 📝 配置检查清单

在完成配置后，请检查：

- [ ] 已获取所有需要的Bot ID
- [ ] 已获取有效的API Key
- [ ] 已正确替换 `js/app.js` 中的占位符
- [ ] 已保存文件修改
- [ ] 已测试至少一个名人的对话功能
- [ ] 收到了来自真实智能体的回复

## 🎯 成功标志

当你看到以下情况时，说明配置成功：

1. 点击名人卡片能正常进入对话页
2. 发送消息后能收到智能体的回复
3. 回复内容符合该名人的性格特征
4. 没有出现"抱歉，我现在有些不舒服"等错误消息

---

完成配置后，你就可以享受与真正的AI名人智能体对话的乐趣了！🎉 